<div class="my-6 rounded-lg border border-gray-200 overflow-hidden">
  <div class="bg-gray-50 px-4 py-2 flex justify-between items-center border-b border-gray-200">
    <span class="font-mono text-sm text-mycolor-500 font-semibold">{{ .Get "file" }}</span>
    <button 
      class="text-gray-500 hover:text-blue-600 transition-colors p-2 rounded hover:bg-gray-100" 
      onclick="copyCode(this)" 
      title="Copier le code">
      <svg class="copy-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
      </svg>
    </button>
  </div>
  <div class="overflow-x-auto overflow-y-auto max-h-120">
    {{ highlight (trim .Inner "\n\r") (.Get "lang") "" }}
  </div>
  {{- /* Stocker le code original pour la copie */ -}}
  <pre class="hidden" data-code>{{- trim .Inner "\n\r" -}}</pre>
</div>

<script>
function copyCode(button) {
  // Récupérer le code depuis l'élément data-code au lieu du HTML formaté
  const codeContainer = button.closest('.my-6');
  const originalCode = codeContainer.querySelector('[data-code]');
  const text = originalCode.textContent;
  
  navigator.clipboard.writeText(text).then(() => {
    const icon = button.querySelector('.copy-icon');
    const originalHTML = icon.innerHTML;
    icon.innerHTML = '<path d="M20 6L9 17l-5-5"></path>';
    icon.setAttribute('stroke', '#10b981');
    setTimeout(() => {
      icon.innerHTML = originalHTML;
      icon.setAttribute('stroke', 'currentColor');
    }, 2000);
  });
}
</script>